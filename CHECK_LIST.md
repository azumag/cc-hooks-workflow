# 実装チェックリスト

## 基本構成
- [ ] プロジェクトディレクトリ構成の作成
  - [ ] `workflow` スクリプトファイル
  - [ ] `hooks/` ディレクトリ
  - [ ] `tests/` ディレクトリ
  - [ ] `docs/` ディレクトリ

## メインスクリプト (workflow)
- [ ] `workflow` スクリプトの作成
  - [ ] 実行権限の設定 (`chmod +x workflow`)
  - [ ] shebang の設定 (`#!/bin/bash`)
  - [ ] 必要な依存関係のチェック (`jq`, `grep`, `tail`)

### 状態管理機能
- [ ] 状態フレーズ抽出機能
  - [ ] トランスクリプトファイル読み込み
  - [ ] 最新の会話ログから状態フレーズ検出
  - [ ] 状態フレーズの正規化処理
- [ ] 状態マッピング機能
  - [ ] ハードコード状態マッピング実装
  - [ ] `NONE` 状態の処理
  - [ ] 未知状態のエラーハンドリング

### 作業報告保存機能
- [ ] 一時ファイル生成
  - [ ] `mktemp` を使用したプロセス安全なファイル名生成
  - [ ] 作業報告内容の抽出と保存
  - [ ] ファイルパスの hooks への受け渡し

### hooks 呼び出し機能
- [ ] スクリプト実行機能
  - [ ] 実行権限チェック
  - [ ] 引数の正しい受け渡し
  - [ ] stdout からの JSON 受け取り
- [ ] JSON レスポンス処理
  - [ ] `jq` を使用した JSON パース
  - [ ] `decision` フィールドの処理
  - [ ] `reason` フィールドの処理
  - [ ] 不正な JSON のエラーハンドリング

## hooks スクリプト
- [ ] 基本的な hooks スクリプトの作成
  - [ ] 実行権限の設定
  - [ ] 引数処理 (`$1: work_summary_file_path`)
  - [ ] JSON 出力フォーマット準備
- [ ] サンプル hooks の実装
  - [ ] レビュー用 hooks
  - [ ] 基本的な承認/拒否 hooks
  - [ ] エラーハンドリング hooks

## エラーハンドリング
- [ ] 一般的なエラー処理
  - [ ] 依存関係不足時のエラー
  - [ ] ファイルアクセスエラー
  - [ ] 権限エラー
  - [ ] 不正な JSON 形式エラー
- [ ] ロギング機能
  - [ ] エラーログの出力
  - [ ] デバッグ情報の出力

## テスト実装
- [ ] テスト環境の構築
  - [ ] bats のインストール/設定
  - [ ] モックファイルの作成
  - [ ] テストデータの準備
- [ ] 単体テスト
  - [ ] 状態フレーズ抽出のテスト
  - [ ] 状態マッピングのテスト
  - [ ] JSON パースのテスト
  - [ ] ファイル操作のテスト
- [ ] 統合テスト
  - [ ] workflow 全体のテスト
  - [ ] hooks 連携のテスト
  - [ ] エラーシナリオのテスト
- [ ] テストスクリプトの作成
  - [ ] `tests/test_workflow.bats`
  - [ ] `tests/test_hooks.bats`
  - [ ] `tests/test_integration.bats`

## CI/CD 設定
- [ ] GitHub Actions 設定
  - [ ] `.github/workflows/test.yml` の作成
  - [ ] テスト自動実行の設定
  - [ ] shellcheck による構文チェック
- [ ] 品質チェック
  - [ ] 実行権限の検証
  - [ ] ファイル構造の検証
  - [ ] テストカバレッジの計測

## ドキュメント
- [ ] 基本ドキュメント
  - [ ] `README.md` の作成
  - [ ] `docs/principal.md` の作成
  - [ ] 使用方法の記述
- [ ] 技術ドキュメント
  - [ ] API仕様の記述
  - [ ] 状態フレーズの仕様
  - [ ] トラブルシューティングガイド

## 実際の運用準備
- [ ] Claude Code との連携
  - [ ] hooks 設定の確認
  - [ ] 実際の動作テスト
  - [ ] パフォーマンステスト
- [ ] 本番環境対応
  - [ ] 異なる環境での動作確認
  - [ ] セキュリティチェック
  - [ ] 運用監視の準備